<div class="container-fluid py-4 animate__animated animate__fadeIn">
  <div class="card shadow-sm border-0 mb-4 bg-primary text-white d-print-none">
    <div class="card-body p-3 d-flex justify-content-between align-items-center">
      <div>
        <h5 class="mb-1"><i class="fas fa-award me-2"></i>สรุปผลการเรียนและตัดเกรด (ปพ.5)</h5>
        <p class="mb-0 small opacity-75">คำนวณเกรดอัตโนมัติ และประเมินคุณลักษณะ 3 ด้าน</p>
      </div>
      <i class="fas fa-medal fa-2x opacity-25"></i>
    </div>
  </div>

  <div class="card shadow-sm border-0 mb-4 d-print-none">
    <div class="card-body">
      <div class="row align-items-end g-2">
        <div class="col-md-5">
          <label class="form-label small fw-bold text-muted"><i class="fas fa-book me-1"></i>เลือกรายวิชาที่ต้องการสรุปผล</label>
          <select id="gradeClassSelect" class="form-select shadow-sm border-primary" onchange="loadGradeSummary()">
            <option value="">⏳ กำลังโหลดวิชา...</option>
          </select>
        </div>
        <div class="col-md-7 text-end">
          <button class="btn btn-outline-dark shadow-sm px-3 fw-bold me-2" onclick="window.print()">
            <i class="fas fa-print me-2"></i>พิมพ์หน้าสรุป (PDF)
          </button>
          <button class="btn btn-success shadow-sm px-4 fw-bold" id="btnSaveGrades" onclick="saveAllGrades()" disabled>
            <i class="fas fa-save me-2"></i>บันทึกและปิดเล่ม
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="card shadow-sm border-0 d-none" id="gradeSummaryCard">
    <div class="card-header bg-dark text-white p-3 text-center print-header">
      <h5 class="mb-1 fw-bold">แบบสรุปผลการประเมินผลการเรียน (ปพ.5)</h5>
      <h6 class="mb-0 text-info" id="gradeSubjectTitle">วิชา... ห้อง...</h6>
    </div>
    
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-0 text-nowrap text-center" style="font-size: 0.85rem;">
          <thead class="table-light text-dark align-middle">
            <tr>
              <th rowspan="2" style="width: 50px;">เลขที่</th>
              <th rowspan="2" class="text-start" style="min-width: 180px;">ชื่อ-สกุล</th>
              <th rowspan="2" style="width: 80px;" class="bg-primary text-white border-primary">คะแนนรวม<br>(100)</th>
              <th rowspan="2" style="width: 80px;" class="bg-success text-white border-success fs-6">ระดับผล<br>การเรียน</th>
              <th colspan="3" class="bg-info-subtle border-info">การประเมิน 3 ด้าน (0-3)</th>
            </tr>
            <tr>
              <th style="width: 100px;" class="bg-info-subtle border-info">การอ่านฯ</th>
              <th style="width: 100px;" class="bg-info-subtle border-info">คุณลักษณะฯ</th>
              <th style="width: 100px;" class="bg-info-subtle border-info">สมรรถนะฯ</th>
            </tr>
          </thead>
          <tbody id="gradeTableBody">
            </tbody>
        </table>
      </div>
    </div>
    
    <div class="card-footer bg-white p-4 d-none d-print-block mt-4 border-0">
      <div class="row text-center mt-5">
        <div class="col-6">
          <p class="mb-5">ลงชื่อ.........................................................ครูผู้สอน</p>
          <p>(.........................................................)</p>
        </div>
        <div class="col-6">
          <p class="mb-5">ลงชื่อ.........................................................หัวหน้าฝ่ายวิชาการ</p>
          <p>(.........................................................)</p>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .qual-select {
    width: 100%;
    text-align: center;
    border: 1px solid #ced4da;
    border-radius: 4px;
    padding: 2px;
    font-weight: bold;
  }
  .qual-select:focus { border-color: #0dcaf0; outline: none; }
  
  /* ตั้งค่าหน้ากระดาษเวลาสั่ง Print (PDF) */
  @media print {
    body * { visibility: hidden; }
    #gradeSummaryCard, #gradeSummaryCard * { visibility: visible; }
    #gradeSummaryCard { position: absolute; left: 0; top: 0; width: 100%; box-shadow: none !important; }
    .d-print-none { display: none !important; }
    .d-print-block { display: block !important; }
    .table-bordered { border: 1px solid #000 !important; }
    .table-bordered th, .table-bordered td { border: 1px solid #000 !important; }
    select { -webkit-appearance: none; -moz-appearance: none; appearance: none; border: none; background: transparent; }
    .bg-primary, .bg-success, .bg-dark, .bg-info-subtle { background-color: #fff !important; color: #000 !important; }
    .text-white { color: #000 !important; }
  }
</style>