<div class="container-fluid py-4 animate__animated animate__fadeIn">
  <div class="card shadow-sm border-0 mb-4 bg-primary text-white d-print-none">
    <div class="card-body p-3 d-flex justify-content-between align-items-center">
      <div>
        <h5 class="mb-1"><i class="fas fa-edit me-2"></i>บันทึกคะแนนและประเมินผล</h5>
        <p class="mb-0 small opacity-75">กรอกคะแนน ตัดเกรดอัตโนมัติ และประเมินคุณลักษณะ</p>
      </div>
      <i class="fas fa-table fa-2x opacity-25"></i>
    </div>
  </div>

  <div class="card shadow-sm border-0 mb-4 d-print-none">
    <div class="card-body">
      <div class="row align-items-end g-2">
        <div class="col-md-5">
          <label class="form-label small fw-bold text-muted"><i class="fas fa-book me-1"></i>เลือกรายวิชาที่ต้องการบันทึก</label>
          <select id="scoreClassSelect" class="form-select shadow-sm border-primary" onchange="loadScoreGrid()">
            <option value="">⏳ กำลังโหลดวิชา...</option>
          </select>
        </div>
        <div class="col-md-7 text-end">
          <button class="btn btn-outline-info shadow-sm px-3 fw-bold me-2" id="btnToggleQual" onclick="toggleQualColumns()">
            <i class="fas fa-eye me-2"></i>ประเมินคุณลักษณะ
          </button>
          <button class="btn btn-outline-primary shadow-sm px-3 fw-bold me-2" id="btnEditHeader" onclick="toggleHeaderEditMode()">
            <i class="fas fa-th me-2"></i>แก้ไขหัวตาราง
          </button>
          <button class="btn btn-outline-dark shadow-sm px-3 fw-bold me-2" onclick="window.print()">
            <i class="fas fa-print me-2"></i>พิมพ์ ปพ.5
          </button>
          <button class="btn btn-success shadow-sm px-4 fw-bold" id="btnSaveScores" onclick="saveAllInOneScores()" disabled>
            <i class="fas fa-save me-2"></i>บันทึกข้อมูลทั้งหมด
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="card shadow-sm border-0 d-none" id="scoreGridCard">
    <div class="card-header bg-dark text-white p-3 d-flex justify-content-between align-items-center print-header">
      <h6 class="mb-0" id="scoreGridTitle"><i class="fas fa-users me-2"></i>แบบบันทึกผลการพัฒนาคุณภาพผู้เรียน (ปพ.5)</h6>
      <span class="badge bg-warning text-dark d-print-none" id="scoreRatioBadge">สัดส่วน -</span>
    </div>
    
    <div class="table-responsive" style="max-height: 65vh; overflow-y: auto; overflow-x: auto;">
      <table class="table align-middle mb-0 text-nowrap" style="font-size: 0.85rem;" id="allInOneTable">
        <thead class="table-light text-center" style="z-index: 4;" id="scoreTableHeader">
          </thead>
        <tbody id="scoreTableBody">
          </tbody>
      </table>
    </div>

  </div>
  
  <div id="scoreEmptyState" class="text-center p-5 text-muted d-none d-print-none">
    <i class="fas fa-exclamation-circle fa-3x mb-3 text-warning"></i>
    <h5>กรุณาตั้งค่า "โครงสร้างวิชา" ก่อนทำการบันทึกคะแนนครับ</h5>
    <button class="btn btn-outline-primary mt-2" onclick="loadPage('Page_Subject_Config')">ไปที่หน้าตั้งค่าโครงสร้างวิชา</button>
  </div>

  <div class="modal fade" id="indicatorDetailModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow-lg" style="border-radius: 12px; overflow: hidden;">
      <div class="modal-header bg-primary text-white border-0 p-3">
        <h6 class="modal-title fw-bold" id="indicatorModalTitle">
          <i class="fas fa-info-circle me-2"></i>รายละเอียดตัวชี้วัด
        </h6>
        <button type="button" class="btn-close btn-close-white shadow-none" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body bg-light p-4">
        <div id="indicatorModalDesc" class="text-dark" style="white-space: pre-wrap; font-size: 0.95rem; line-height: 1.6;">
          </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="indicatorEditModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content border-0 shadow-lg" style="border-radius: 12px; overflow: hidden;">
      <div class="modal-header bg-primary text-white border-0 p-3">
        <h6 class="modal-title fw-bold" id="indicatorEditModalTitle">
          <i class="fas fa-edit me-2"></i>รายละเอียดตัวชี้วัด/จุดประสงค์
        </h6>
        <button type="button" class="btn-close btn-close-white shadow-none" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body bg-light p-4">
        <input type="hidden" id="editIndIdx">
        
        <div class="mb-3">
          <label class="form-label fw-bold text-muted small">คำอธิบายรายละเอียด / จุดประสงค์การเรียนรู้</label>
          <textarea id="editIndDesc" class="form-control shadow-sm border-primary" rows="5" 
                    placeholder="กรอกรายละเอียดที่จำเป็นสำหรับการประเมินผล หรือเก็บไว้เป็นฐานข้อมูลในปีการศึกษาหน้า..."></textarea>
        </div>
      </div>
      <div class="modal-footer bg-light border-top-0 pt-0 d-flex justify-content-between">
        <span class="text-muted small"><i class="fas fa-database me-1"></i>ข้อมูลจะถูกเก็บเป็นฐานข้อมูลวิชา</span>
        <div>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ยกเลิก</button>
          <button type="button" class="btn btn-success fw-bold px-4" onclick="saveIndicatorDetail()">
            <i class="fas fa-save me-2"></i>บันทึกข้อมูล
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

</div>